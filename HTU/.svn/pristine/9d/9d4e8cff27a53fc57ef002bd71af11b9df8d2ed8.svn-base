<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.ddit.mapper.DormitoryMapper">
	
	<insert id="createApplyDormitoryConsent" parameterType="approvalVO">
		<selectKey resultType="String" keyProperty="appCd" order="BEFORE">
			SELECT 
				approval_SEQ.nextVal
			FROM DUAL
		</selectKey>
			INSERT INTO APPROVAL (
			    APP_CD,
			    USER_CD,
			    COMD_CD,
			    APP_TARGET
				)
			VALUES (
			    #{appCd},
			    #{userCd},
			    'APPR05', <!-- 결재유형코드 -->
			    '1001' 
				)
	</insert>
	
	<insert id="createApplyDormitory" parameterType="dormitoryVO">
		<selectKey keyProperty="domCd" resultType="String" order="BEFORE">
		SELECT 'DO' || TRIM(TO_CHAR(DORMITORY_SEQ.NEXTVAL,'00000')) FROM DUAL
	    </selectKey>
		INSERT INTO DORMITORY(DOM_CD, ROOM_CD, STU_CD, APP_CD, COMD_CD, DOM_YEAR, DOM_SEM)
		VALUES(#{domCd},#{roomCd},#{stuCd},#{appCd},#{comdCd},#{domYear},#{domSem})
	</insert>
</mapper>









