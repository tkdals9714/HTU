<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<%@ taglib prefix="sec"
	uri="http://www.springframework.org/security/tags"%>

<link rel="stylesheet" href="path/to/fontawesome/css/all.min.css" />
<sec:authentication property="principal.userVO" var="userVO" />
<input type="hidden" name="taskCd" value="${taskVO.taskCd}" id="taskCd" />
<input type="hidden" name="lecCd" value="${taskVO.lecCd}" />


<input type="hidden" id="taskCd" value="${taskVO.taskCd}" />
<input type="hidden" id="stuCd" value="${userVO.userCd}" />
<!-- <button type="button" id="tasksubmitButton">버튼@@@@</button> -->
<!-- <input type="file" name="uploadFiles" id="submitFile" multiple="multiple" /> -->

<!-- <script> -->
<!-- //     function goBack() { -->
<!-- //         window.history.back(); -->
<!-- //     } -->
<!-- </script> -->

<script>
$(function() {
	$("#lecNm").text($(".sub_title").text());
	const formData = new FormData();
	var taskCd = $('#taskCd').val();
	var stuCd = $('#stuCd').val();

	$("#submitFile").change(function() {
		var files = files = $("#submitFile")[0].files;
		for (var i = 0; i < files.length; i++) {
			formData.append("files", files[i]);
		}
	});
	const data = {
		"taskCd" : taskCd,
		"stuCd" : stuCd
	}
	formData.append("taskSubmitVO", new Blob([ JSON.stringify(data) ], {type : "application/json"}));
	$('#tasksubmitButton').on('click', function() {
		$.ajax({
			url : "/student/task/submit",
			type : "post",
			data : formData, // formData를 직접 사용
			processData : false,
			contentType : false,
			beforeSend : function(xhr) {
				xhr.setRequestHeader("${_csrf.headerName}",
						"${_csrf.token}");
			},
			success : function(res) {
				console.log(res);
			},
			error : function(xhr) {
				console.log(xhr);
			}
		});
	});
});
</script>