<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<%@ taglib prefix="sec"
	uri="http://www.springframework.org/security/tags"%>

<link rel="stylesheet" href="path/to/fontawesome/css/all.min.css" />

<sec:authentication property="principal.userVO" var="userVO" />
<input type="hidden" name="taskCd" value="${taskVO.taskCd}" id="taskCd" />
<input type="hidden" name="lecCd" value="${taskVO.lecCd}" />


<input type="hidden" id="taskCd" value="${taskVO.taskCd}" />
<input type="hidden" id="stuCd" value="${userVO.userCd}" />

<div style="width:100%; height:100%; padding:30px; background-color:#ffffff;">
	<div style="border-bottom:1px solid #333; padding-bottom:20px; ">
		<!-- 타이틀 -->
		<input name="lecCd" value="타이틀입력input" style="font-size:28px; font-weight:600;"/>
		<!-- 교수명, 제출일  -->
		<div style="font-size:13px; display:flex; align-items:center; margin-top:10px;">
			<!-- 교수명 -->
			<input value="교수명" style="font-size:15px; width:50px; text-align:left;"/>
			<span style="font-size:20px;">&nbsp;ㆍ&nbsp;</span>
			<!-- 제출일 -->
			<input value="24.01.05" style="font-size:15px; width:70px;"/>
		</div>
		<!-- 점수배점 -->
		<div style="display:flex; font-size:15px; align-items:center;">
			<span style="height:23.6px; line-height:23.6px;">점수배점&nbsp;&nbsp;:&nbsp;&nbsp;</span>
			<input value="100" style="font-size:15px; width:40px;"/>
		</div>
	</div>
  <div style="display:flex; margin-top:20px; height:72%; justify-content:space-between; border-bottom:1px solid #ccc; padding-bottom:20px; ">
		<!-- 과제내용  -->
		<div style="padding:20px; width:calc(100% - 300px); margin-right:20px;">
		과제내용입니다
		</div>
		<div style="position:relative; width:300px; height:150px; padding:20px; box-sizing:border-box; border:1px solid #ccc; border-radius:5px; margin-top:20px; box-shadow: 0 1px 2px 0 rgba(60,64,67,.3), 0 2px 6px 2px rgba(60,64,67,.15);">
			<div style="display:flex; justify-content:space-between; align-items:end;">	
				<div style="font-size:20px;">과제제출함</div>
				<!-- 제출완료시 표시 -->
				<div style="font-size:15px;">제출완료</div>
			</div>
			<input type="file" name="uploadFiles" id="submitFile" multiple="multiple" style="margin-top:20px; width:100%; font-size:14px; border:1px solid #ccc; line-height:23px; height:30px; background-color:#fff;border-radius:3px;"/>
			<button type="button" id="tasksubmitButton" style="border:1px solid #ccc; border-radius:3px; background-color:#ebebeb; font-size:13px; height:30px; margin-top:5px; line-height:30px; position:absolute; right:20px; bottom:20px;">과제제출</button>
		</div>
  </div>	
	<!-- 목록 버튼 -->
	<button class="btn-two mini dark" onclick="goBack()"
			style="position:relative; left:50%; transform:translateX(-50%);width:80px; height:30px; font-size:14px;">
	목록</button>
	<!-- 목록 버튼 끝 -->
</div>
<!-- <button type="button" id="tasksubmitButton">버튼@@@@</button> -->
<!-- <input type="file" name="uploadFiles" id="submitFile" multiple="multiple" /> -->

<script>
	function goBack() { 
	 window.history.back();
   } 
	
$(function() {
	$("#lecNm").text($(".sub_title").text());
	const formData = new FormData();
	var taskCd = $('#taskCd').val();
	var stuCd = $('#stuCd').val();

	$("#submitFile").change(function() {
		var files = files = $("#submitFile")[0].files;
		for (var i = 0; i < files.length; i++) {
			formData.append("files", files[i]);
		}
	});
	const data = {
		"taskCd" : taskCd,
		"stuCd" : stuCd
	}
	formData.append("taskSubmitVO", new Blob([ JSON.stringify(data) ], {type : "application/json"}));
	$('#tasksubmitButton').on('click', function() {
		$.ajax({
			url : "/student/task/submit",
			type : "post",
			data : formData, // formData를 직접 사용
			processData : false,
			contentType : false,
			beforeSend : function(xhr) {
				xhr.setRequestHeader("${_csrf.headerName}",
						"${_csrf.token}");
			},
			success : function(res) {
				console.log(res);
			},
			error : function(xhr) {
				console.log(xhr);
			}
		});
	});
});
</script>