<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="sec"
	uri="http://www.springframework.org/security/tags"%>
<!-- style.css -->
<link href="/resources/css/counsel.css" rel="stylesheet" type="text/css">

<div class="counsel_box">
	<a href="/student/counsel/counselApp" class="app_btn">상담신청</a>
	<table>
		<tr class="table_title">
			<td>순번</td>
			<td>상담종류</td>
			<td>상담일</td>
			<td>교수명</td>
			<td>승인여부</td>
			<!-- 상담날짜 이후에 써짐 -->
			<td>수정/취소</td>
			<td>상담내역</td>
		</tr>
		<c:forEach var="counselVO" items="${data}" varStatus="stat">
		<tr>
			<td>${stat.count}</td>
			<td>${counselVO.commonDetailVO.comdNm}</td>
			<td>${counselVO.cnslDt}</td>
			<td>${counselVO.professorVO.userVO.userNm}</td>
			<td id="appYn">
				<c:choose>
					<c:when test="${counselVO.approvalVO.appYn eq 0}"><p class="btn-two mini green">대기</p></c:when>
					<c:when test="${counselVO.approvalVO.appYn eq 1}"><p class="btn-two mini sky">승인</p></c:when>
					<c:when test="${counselVO.approvalVO.appYn eq 2}"><p class="btn-two mini orange">반려</p></c:when>
				</c:choose>
			</td>
			<td>
			<%-- onclick="location.href='/student/counsel/counseldetail?cnslCd=${counselVO.cnslCd}'" --%>
			<%-- <c:if test="${counselVO.approvalVO.appYn != 0}">disabled</c:if> --%>
				<button class="btn-two blue mini modify-btn" data-app-yn="${counselVO.approvalVO.appYn}" onclick="location.href = '/student/counsel/counseldetail?cnslCd=${counselVO.cnslCd}'">수정</button>
				<button  class="btn-two red mini cancle-btn" data-app-yn="${counselVO.approvalVO.appYn}">상담취소</button>
			</td>
			<td><button class="btn-two gray mini">상담내용상세</button></td>
		</tr>
		</c:forEach>
		
	</table>
</div>
<script>

$(".modify-btn").each(function() {
	const appYn= $(this).data("appYn");
/* 	const cnslCd=$(this).data("cnslCd"); */
	console.log(appYn,typeof appYn);
/* 	console.log(cnslCd); */
	if (appYn > 0) {
	    $(this).hide();
	}else{
	}
	
})
$(".cancle-btn").each(function() {
	const appYn= $(this).data("appYn");
	console.log(appYn,typeof appYn);
	if (appYn > 0) {
	    $(this).hide();
	}else{
		$(this).on("click", function() {
            location.href = '/student/counsel/counseldetail?cnslCd=${counselVO.cnslCd}';
        });
	}
	
})
</script>






